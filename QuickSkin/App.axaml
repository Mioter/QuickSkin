<Application xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:semi="https://irihi.tech/semi"
             xmlns:u-Semi="https://irihi.tech/ursa/themes/semi"
             xmlns:u="https://irihi.tech/ursa"
             xmlns:viewModels="clr-namespace:QuickSkin.ViewModels"
             xmlns:converters="clr-namespace:QuickSkin.UI.Converters"
             x:Class="QuickSkin.App"
             x:DataType="viewModels:ApplicationViewModel"
             RequestedThemeVariant="{Binding UiConfig.Theme}">
    <!-- "Default" ThemeVariant follows system theme variant. "Dark" or "Light" are other available options. -->

    <Application.Styles>

        <semi:SemiPopupAnimations />
        <semi:SemiTheme Locale="zh-CN" />
        <semi:ColorPickerSemiTheme />
        <u-Semi:SemiTheme Locale="zh-CN" />

        <!-- 窗口样式 -->

        <StyleInclude Source="Assets/AvaloniaRes/ControlThemes/.index.axaml" />
        <StyleInclude Source="Assets/AvaloniaRes/Styles/.index.axaml" />
        <StyleInclude Source="Assets/AvaloniaRes/Icons/.index.axaml" />

        <Style Selector="u|TitleBar /template/ u|CaptionButtons#PART_CaptionButtons">
            <Setter Property="MinHeight" Value="40" />
        </Style>

        <Style Selector="u|TitleBar /template/ u|CaptionButtons#PART_CaptionButtons:normal /template/ StackPanel">
            <Setter Property="Margin" Value="5" />
            <Setter Property="Spacing" Value="5" />
        </Style>

        <Style Selector="u|TitleBar /template/ u|CaptionButtons#PART_CaptionButtons /template/ Button">
            <Setter Property="Height" Value="30" />
            <Setter Property="Width" Value="30" />
            <Setter Property="CornerRadius" Value="8" />
        </Style>

        <Style Selector="u|TitleBar /template/ u|CaptionButtons#PART_CaptionButtons">
            <Style Selector="^:normal /template/ PathIcon#PART_CloseButtonIcon">
                <Setter Property="Data" Value="{StaticResource SemiIconClose}" />
                <Setter Property="Height" Value="13.5" />
            </Style>
            <Style Selector="^:maximized /template/ PathIcon#PART_CloseButtonIcon">
                <Setter Property="Data" Value="{StaticResource SemiIconClose}" />
                <Setter Property="Height" Value="13.5" />
            </Style>
        </Style>

        <!-- 控件样式 -->

        <Style Selector="CheckBox">
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>

        <Style Selector="TextBox">
            <Setter Property="CornerRadius" Value="8" />
        </Style>

        <Style Selector="ToolTip /template/ ContentPresenter">
            <Setter Property="FontSize" Value="12" />

        </Style>

        <Style Selector="ComboBox.Bordered">
            <Style Selector="^:pointerover /template/ Border#Background">
                <Setter Property="BorderBrush" Value="{DynamicResource SemiLightBlue5}" />
            </Style>

            <Style Selector="^:focus /template/ Border#Background">
                <Setter Property="BorderBrush" Value="{DynamicResource SemiBlue5}" />
            </Style>

            <Style Selector="^:pressed /template/ Border#Background">
                <Setter Property="BorderBrush" Value="{DynamicResource SemiBlue5}" />
            </Style>

            <Style Selector="^ /template/ Border#PopupBorder:focus-within">
                <Setter Property="Background" Value="{DynamicResource SemiColorBackground1}" />
                <Setter Property="CornerRadius" Value="8" />
                <Setter Property="Padding" Value="0,4" />
                <Setter Property="BorderThickness" Value="0" />
                <Setter Property="BoxShadow" Value="{DynamicResource LightColorShadow}" />
            </Style>
        </Style>

        <Style Selector="TextBox.Bordered">
            <Style Selector="^ /template/ Border#PART_ContentPresenterBorder">
                <Setter Property="BorderBrush" Value="{DynamicResource SemiColorBorder}" />
            </Style>

            <Style Selector="^:pointerover /template/ Border#PART_ContentPresenterBorder">
                <Setter Property="BorderBrush" Value="{DynamicResource SemiLightBlue5}" />
            </Style>

            <Style Selector="^:focus /template/ Border#PART_ContentPresenterBorder">
                <Setter Property="BorderBrush" Value="{DynamicResource SemiBlue5}" />
            </Style>

            <Style Selector="^:pressed /template/ Border#PART_ContentPresenterBorder">
                <Setter Property="BorderBrush" Value="{DynamicResource SemiBlue5}" />
            </Style>
            
            <Style Selector="^:error">

                <Style Selector="^ /template/ Border#PART_ContentPresenterBorder">
                    <Setter Property="Background" Value="{DynamicResource DataValidationErrorsBackground}" />
                    <Setter Property="BorderBrush" Value="{DynamicResource DataValidationErrorsBorderBrush}" />
                </Style>

                <Style Selector="^:pointerover /template/ Border#PART_ContentPresenterBorder">
                    <Setter Property="Background" Value="{DynamicResource DataValidationErrorsPointerOverBackground}" />
                    <Setter Property="BorderBrush" Value="{DynamicResource DataValidationErrorsPointerOverBorderBrush}" />
                </Style>

                <Style Selector="^:pressed /template/ Border#PART_ContentPresenterBorder">
                    <Setter Property="Background" Value="{DynamicResource DataValidationErrorsPressedBackground}" />
                    <Setter Property="BorderBrush" Value="{DynamicResource DataValidationErrorsPressedBorderBrush}" />
                </Style>

                <Style Selector="^:focus /template/ Border#PART_ContentPresenterBorder">
                    <Setter Property="Background" Value="{DynamicResource DataValidationErrorsSelectedBackground}" />
                    <Setter Property="BorderBrush" Value="{DynamicResource DataValidationErrorsSelectedBorderBrush}" />
                </Style>

            </Style>

        </Style>
        
        <Style Selector="u|NotificationCard /template/ Button#PART_CloseButton">
            <Setter Property="CornerRadius" Value="8" />
        </Style>

        <Style Selector="u|MessageBoxControl /template/ Button">
            <Setter Property="CornerRadius" Value="8" />
        </Style>

        <Style Selector=":is(u|DrawerControlBase) /template/ Button#PART_CloseButton">
            <Setter Property="CornerRadius" Value="8" />
        </Style>

        <Style
            Selector="TextBox.TextBoxErrorsCenter /template/ DataValidationErrors /template/ ContentControl#InlineDataValidationContentControl">
            <Setter Property="HorizontalAlignment" Value="Center" />
        </Style>

        <Style Selector=":is(u|DialogControlBase) /template/ Button#PART_CloseButton">
            <Setter Property="CornerRadius" Value="12" />
            <Setter Property="Height" Value="25" />
            <Setter Property="Width" Value="25" />

            <Style Selector="^ /template/ PathIcon">
                <Setter Property="Height" Value="15" />
                <Setter Property="Width" Value="15" />
            </Style>

        </Style>

        <Style Selector=":is(u|NumericUpDown)">
            <Setter Property="CornerRadius" Value="8" />
        </Style>

        <Style Selector=":is(Window)">
            <Setter Property="FontFamily" Value="{DynamicResource AppFont}" />
        </Style>

        <Style Selector=":is(ContextMenu)">
            <Setter Property="FontFamily" Value="{DynamicResource AppFont}" />
        </Style>
        
        <!-- 过渡效果 & 动画 -->

        <Style Selector=":is(Button)">
            <Setter Property="Transitions">
                <Transitions>
                    <TransformOperationsTransition Duration="0:0:0.1" Property="RenderTransform" />
                </Transitions>
            </Setter>

            <Style Selector="^:pressed">
                <Setter Property="RenderTransform" Value="translateY(1px)" />
            </Style>

        </Style>

        <Style Selector=":is(Control).LoadedAnimation">
            <Setter Property="Opacity" Value="1" />
            <Setter Property="RenderTransform" Value="scale(1)" />
        </Style>

        <Style Selector=":is(Control).UnLoadedAnimation">
            <Setter Property="Opacity" Value="0" />
            <Setter Property="RenderTransform" Value="scale(0)" />
        </Style>

    </Application.Styles>

    <Application.Resources>

        <converters:EnumDescriptionConverter x:Key="EnumDescriptionConverter" />
        <converters:StringCompareConverter x:Key="StringCompareConverter" />
        <converters:StringUnequalConverter x:Key="StringUnequalConverter" />
        <converters:ObjectCompareMultiConverter x:Key="InstanceEqualityMultiConverter" />
        <converters:CalcConverter x:Key="CalcConverter" />
        <converters:SolidColorBrushToTransparentConverter x:Key="SolidColorBrushToTransparentConverter" />

        <!-- 基础 -->

        <BoxShadows x:Key="LightColorShadow">0 0 10 0 LightGray</BoxShadows>

        <DropShadowEffect x:Key="LightColorDropShadowEffect" BlurRadius="10" Color="LightGray" OffsetX="0" OffsetY="0" />

        <!--定制-->

        <CornerRadius x:Key="FlyoutCornerRadius">8</CornerRadius>

        <CornerRadius x:Key="ButtonCornerRadius">8</CornerRadius>

        <CornerRadius x:Key="DrawerCornerRadius">8</CornerRadius>

        <CornerRadius x:Key="ComboBoxSelectorCornerRadius">8</CornerRadius>

    </Application.Resources>

    <TrayIcon.Icons>
        <TrayIcons>
            <TrayIcon Icon="resm:QuickSkin.Assets.EmbeddedRes.app-icon.ico" MacOSProperties.IsTemplateIcon="true"
                      ToolTipText="QwQ Music"
                      Command="{Binding ShowMainWindowCommand}">

                <TrayIcon.Menu>
                    <NativeMenu>
                        <NativeMenuItem Header="显示窗口" Command="{Binding ShowMainWindowCommand}" />
                        <NativeMenuItem Header="退出" Command="{Binding ExitApplicationCommand}" />
                    </NativeMenu>
                </TrayIcon.Menu>

            </TrayIcon>
        </TrayIcons>
    </TrayIcon.Icons>

</Application>